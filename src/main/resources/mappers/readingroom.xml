<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="kr.co.literal.readingroom.dao.BranchMapper">

    <!-- 예약 결제 테이블 -->
    <insert id="insertReservation" parameterType="kr.co.literal.readingroom.dto.ReservationDTO">
        INSERT INTO reservation (reservation_code, room_code, mycoupon_number, reservation_total, seat_code, reservation_payment, time_code, end_time, reservation_date, using_seat, re_name, re_phone, branch_code, start_time)
        VALUES (#{reservation_code}, #{room_code}, #{mycoupon_number}, #{reservation_total}, #{seat_code}, #{reservation_payment}, #{time_code}, #{end_time}, #{reservation_date}, #{using_seat}, #{re_name}, #{re_phone}, #{branch_code}, #{start_time})
    </insert>

    <!-- 이용권 테이블 -->
    <insert id="insertReadingRoom" parameterType="kr.co.literal.readingroom.dto.ReadingRoomDTO">
        INSERT INTO reading_room (room_code, duration, room_amount) 
        VALUES (#{room_code}, #{duration}, #{room_amount})
    </insert>

    <!-- 좌석 테이블 -->
    <insert id="insertSeat" parameterType="kr.co.literal.readingroom.dto.SeatDTO">
        INSERT INTO seat (seat_code, branch_code, row, column, visible)
        VALUES (#{seat_code}, #{branch_code}, #{row}, #{column}, #{visible})
    </insert>

    <!-- 이용시간 테이블 -->
    <insert id="insertUseTime" parameterType="kr.co.literal.readingroom.dto.UseTimeDTO">
        INSERT INTO use_time (time_code, start_time) 
        VALUES (#{time_code}, #{start_time})
    </insert>

    <!-- 마이이용권 테이블 -->
    <insert id="insertMyCoupon" parameterType="kr.co.literal.readingroom.dto.MyCouponDTO">
        INSERT INTO my_coupon (email, mycoupon_number, room_code, issue_date, expiry_date, usage_date) 
        VALUES (#{email}, #{mycoupon_number}, #{room_code}, #{issue_date}, #{expiry_date}, #{usage_date})
    </insert>

    <!-- 지점 branch -->
    <!-- 지점테이블 -->
    <insert id="insertBranch" parameterType="kr.co.literal.readingroom.dto.BranchDTO">
        INSERT INTO branch (branch_code, branch_name, branch_email, branch_pw, branch_detail, branch_address, latitude, longitude)
        VALUES (#{branch_code}, #{branch_name}, #{branch_email}, #{branch_pw}, #{branch_detail}, #{branch_address}, #{latitude}, #{longitude})
    </insert>

    <!-- 모든 지점 목록 -->
    <select id="selectAllBranches" resultType="kr.co.literal.readingroom.dto.BranchDTO">
        SELECT branch_code, branch_name, branch_email, branch_pw, branch_detail, branch_address, latitude, longitude 
        FROM branch
    </select>

    <!-- Branch 조회 -->
    <select id="selectBranchByCode" parameterType="String" resultType="kr.co.literal.readingroom.dto.BranchDTO">
        SELECT branch_code, branch_name, branch_email, branch_pw, branch_detail, branch_address, latitude, longitude 
        FROM branch 
        WHERE branch_code = #{branch_code}
    </select>

    <!-- 해당 Branch의 좌석 조회 -->
    <select id="selectSeatsByBranchCode" parameterType="String" resultType="kr.co.literal.readingroom.dto.SeatDTO">
        SELECT seat_code, branch_code, row, column, visible 
        FROM seat 
        WHERE branch_code = #{branch_code}
    </select>
</mapper>
